(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-admin-bgsx"],{"0da5":function(t,e,n){"use strict";n.r(e);var i=n("4ba5e"),a=n.n(i);for(var u in i)"default"!==u&&function(t){n.d(e,t,(function(){return i[t]}))}(u);e["default"]=a.a},"4ba5e":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{tableData:[],pageSize:7,pageCurrent:1,total:0,selectedIndexs:[],pageSizeIndex:0,pageSizeOption:[7,10,20,50,100,200],loading:!1,login:!1,userInfo:{},customStyle:{margin:"10rpx"},url:""}},onLoad:function(){this.url=getApp().globalData.url;try{var t=uni.getStorageSync("userInfo");if(!t)return this.login=!1,uni.navigateTo({url:"/pages/user/login"}),this.$u.toast("请先登录");this.userInfo=t,this.login=!0,this.selectedIndexs=[],"admin"!=t.Role&&"cjsjgl"!=t.Role?(this.$u.toast("无权进入"),setTimeout((function(){uni.switchTab({url:"/pages/cx/index"})}),500)):this.getData(this.pageCurrent)}catch(e){console.log("获取用户信息失败",e)}},onPullDownRefresh:function(){this.getData(this.pageCurrent),setTimeout((function(){uni.stopPullDownRefresh()}),500)},methods:{gohome:function(){uni.switchTab({url:"/pages/cx/index"})},changeSize:function(t){this.pageSizeIndex=t.detail.value,this.pageSize=this.pageSizeOption[t.detail.value],this.getData(this.pageCurrent)},change:function(t){this.selectedIndexs.length=0,this.getData(t.current)},getData:function(t){var e=this;this.loading=!0,this.pageCurrent=t,uni.request({url:this.url+"/admin/system/getAllBgsxList",method:"GET",header:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.userInfo.token},data:{pageSize:this.pageSize,total:this.total,page:this.pageCurrent},success:function(t){if(401==t.statusCode)uni.showToast({title:"登录已过期",success:function(t){setTimeout((function(){uni.removeStorageSync("userInfo"),e.login=!1,e.userInfo={},uni.navigateTo({url:"/pages/user/login"})}),600)}});else{if(!t.data.result)return e.$u.toast("暂无数据");e.tableData=t.data.result.items,e.total=t.data.result.total,e.loading=!1}}})},views:function(t){uni.navigateTo({url:"/pages/admin/table?id="+t})},create:function(){uni.navigateTo({url:"/pages/admin/bgsxcreate"})},edit:function(t){uni.navigateTo({url:"/pages/admin/bgsxedit?id="+t})},del:function(t){var e=this;uni.showModal({title:"确认删除？",content:"删除后无法恢复",success:function(n){n.confirm&&uni.request({url:e.url+"/admin/system/delbgsx",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+e.userInfo.token},data:{ID:t,isdel:0},success:function(t){if(401!=t.statusCode)return 0==t.data.code&&e.getData(e.pageCurrent),e.$u.toast(t.data.message);uni.showToast({title:"登录已过期",success:function(t){setTimeout((function(){uni.removeStorageSync("userInfo"),e.login=!1,e.userInfo={},uni.navigateTo({url:"/pages/user/login"})}),600)}})}})}})}}};e.default=i},a3d7:function(t,e,n){"use strict";n.r(e);var i=n("f5aa"),a=n("0da5");for(var u in a)"default"!==u&&function(t){n.d(e,t,(function(){return a[t]}))}(u);var s,o=n("f0c5"),r=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"3519f556",null,!1,i["a"],s);e["default"]=r.exports},f5aa:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i}));var i={uIcon:n("0f2d").default,uniTable:n("e66e").default,uniTr:n("88c5").default,uniTh:n("9bd1").default,uniTd:n("6b1a").default,uButton:n("a25e").default,uniIcons:n("f5ae").default,uniPagination:n("607b").default},a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",["admin"==t.userInfo.Role||"cjsjgl"==t.userInfo.Role?n("v-uni-view",{staticClass:"uni-header"},[n("u-icon",{attrs:{name:"home",label:"查询/填报项目","label-size":"33",size:"36"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gohome.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"u-row-left u-m-20"},[n("v-uni-button",{staticClass:"uni-button",attrs:{type:"primary",size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.create.apply(void 0,arguments)}}},[t._v("新建项目")])],1)],1):t._e(),"admin"==t.userInfo.Role||"cjsjgl"==t.userInfo.Role?n("v-uni-view",{staticClass:"uni-container"},[n("uni-table",{ref:"table",attrs:{loading:t.loading,border:!0,stripe:!0,emptyText:"暂无更多数据"}},[n("uni-tr",[n("uni-th",{attrs:{width:"230",align:"center"}},[t._v("项目和创建日期")]),n("uni-th",{attrs:{width:"175",align:"center"}},[t._v("操作")])],1),t._l(t.tableData,(function(e,i){return n("uni-tr",{key:i},[n("uni-td",[n("v-uni-view",{staticClass:"u-font-sm",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.views(e.ID)}}},[t._v(t._s(e.Xmmc)+"\n\t\t\t\t\t\t"+t._s(t.$u.timeFormat(e.CreatedAt,"yyyy-mm-dd")))])],1),n("uni-td",[n("v-uni-view",{staticClass:"uni-group"},[n("u-button",{attrs:{size:"mini",type:"success","custom-style":t.customStyle,plain:!0},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.views(e.ID)}}},[t._v("查看")]),n("u-button",{attrs:{size:"mini",type:"primary","custom-style":t.customStyle,plain:!0},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.edit(e.ID)}}},[t._v("设置")]),n("u-button",{attrs:{size:"mini",type:"error","custom-style":t.customStyle,plain:!0},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.del(e.ID)}}},[t._v("删除")])],1)],1)],1)}))],2)],1):t._e(),n("v-uni-view",{staticClass:"uni-pagination-box"},[n("v-uni-picker",{staticClass:"select-picker",attrs:{mode:"selector",value:t.pageSizeIndex,range:t.pageSizeOption},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeSize.apply(void 0,arguments)}}},[n("v-uni-button",{attrs:{type:"default",size:"mini",plain:!0}},[n("v-uni-text",[t._v(t._s(t.pageSizeOption[t.pageSizeIndex])+" 条/页")]),n("uni-icons",{staticClass:"select-picker-icon",attrs:{type:"arrowdown",size:"12",color:"#999"}})],1)],1),n("uni-pagination",{attrs:{"page-size":t.pageSize,total:t.total},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.change.apply(void 0,arguments)}},model:{value:t.pageCurrent,callback:function(e){t.pageCurrent=e},expression:"pageCurrent"}})],1)],1)},u=[]}}]);